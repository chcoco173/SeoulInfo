<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.dao.MemberDAO">
	
	<!-- 회원가입 : DB입력 -->
	<insert id="insertMember" parameterType="MemberVO">
		INSERT INTO member ( member_id, member_pw, member_name, member_tel, member_email, member_area )
		VALUES ( #{member_id}, #{member_pw}, #{member_name}, #{member_tel}, #{member_email}, #{member_area} )	
	</insert>

	<!-- 8/2 회원수정 : DB입력 -->	
    <select id="updateMember" parameterType="MemberVO" resultType="MemberVO">
        UPDATE member 
        SET member_id=#{member_id}, member_pw=#{member_pw}, member_name=#{member_name}, member_tel=#{member_tel}, member_email=#{member_email}, member_area=#{member_area} 
        WHERE member_id=#{member_id}
    </select>
	<select id="getMemberById" parameterType="MemberVO">
		SELECT * FROM member
		WHERE member_id=#{member_id}
	</select>    
    	
	
	<!-- 로그인 : DB확인 -->
	<select id="loginCheck" parameterType="MemberVO">
		SELECT * FROM member
		WHERE member_id=#{member_id}
	</select>
	
	<!-- 아이디찾기 -->
	<select id="idSearch" parameterType="MemberVO">
		SELECT * FROM member
		WHERE member_name=#{member_name} AND member_email=#{member_email}
	</select>
	
	<!-- 비밀번호찾기 -->
	<select id="pwSearch" parameterType="MemberVO">
		SELECT * FROM member
		WHERE member_name=#{member_name} AND member_email=#{member_email} AND member_id=#{member_id}				
	</select>
			
	
	<!-- 아이디 중복체크 -->
	<select id="idChk" parameterType="String" resultType="int">
		SELECT COUNT(*) FROM member
		WHERE member_id=#{member_id}
	</select>
	
	<!-- 이메일 중복체크 -->
	<select id="emailChk" parameterType="String" resultType="int">
		SELECT COUNT(*) FROM member
		WHERE member_email=#{member_email}
	</select>
		
	
	<!-- 이메일인증 -->
	<select id="findByEmail" parameterType="String" resultType="MemberVO">
		SELECT * FROM member
		WHERE member_email=#{member_email}
	</select>	
    <select id="findMemberByEmail" parameterType="String" resultType="MemberVO">
        SELECT * FROM member WHERE member_email=#{member_email}
    </select>	

	<!-- 임시비밀번호 변경 -->
    <select id="checkEmail" resultType="Integer">
        SELECT COUNT(*) FROM member WHERE member_email = #{member_email}
    </select>

    <update id="updatePassword">
        UPDATE member SET member_pw = #{newPassword} WHERE member_email = #{member_email}
    </update>	



    <!-- 8/1 네이버 로그인 -->
    <!-- 이메일로 사용자 등록 여부 확인 -->
    <select id="checkUserByEmail" parameterType="String" resultType="boolean">
        SELECT COUNT(*) > 0
        FROM member
        WHERE member_email = #{member_email}
    </select>
    
    <!-- 이메일로 사용자 이름 가져오기 -->
<!--     <select id="getUserNameByEmail" parameterType="String" resultType="String">
        SELECT member_name
        FROM member
        WHERE member_email = #{member_email}
    </select> -->
    <!-- 이메일로 전체 사용자 정보 가져오기 -->	
    <select id="getMemberByEmail" parameterType="String" resultType="MemberVO">
        SELECT *
        FROM member
        WHERE member_email = #{member_email}
    </select>	
	

	<!-- 8/6 프로필 사진 등록 -->
	<update id="updateProfile" parameterType="MemberVO">
		UPDATE member 
		SET member_imageOrigin=#{member_imageOrigin}, member_imageName=#{member_imageName}, member_imagePath=#{member_imagePath}
		WHERE member_id=#{member_id}		
	</update>
<!-- 	<insert id="insertProfile" parameterType="MemberVO">
		INSERT INTO member ( member_id, member_imageOrigin, member_imageName, member_imagePath )
		VALUES ( #{member_id}, #{member_imageOrigin}, #{member_imageName}, #{member_imagePath} )		
	</insert> -->	
	
<!-- 	<update id="updateProfile" parameterType="MemberVO">		
		UPDATE member
		set title = #{title},
			content = #{content}
		WHERE seq = #{seq}		
	</update>
	
	<delete id="deleteProfile" parameterType="MemberVO">	
		DELETE FROM member
		WHERE seq = #{seq}		
	</delete>
	
		<select id="getProfileList" resultType="MemberVO">	
		SELECT *
		FROM member
		ORDER BY SEQ DESC
	</select> -->

<!-- 	
	<select id="getBoard" parameterType="MemberVO" resultType="MemberVO">	
		SELECT *
		FROM member
		WHERE SEQ = #{seq}		
	</select>
 -->
 
 	<!-- 조인이 포함되어 있으면 resultType="hashmap" 필수로 변경 -->
<!-- 	<select id="getBoard" parameterType="MemberVO" resultType="hashmap">	
		SELECT 
			b.seq		seq
			,b.title	title
			,b.writer	writer
			,b.content  content
			,b.regdate  regdate 
			,b.cnt		cnt 
			,bf.originFilename originFilename
			,bf.filename	filename
		FROM  board2 b INNER JOIN board_file bf 
		ON 	  b.fileid = bf.fileid 
		WHERE b.seq=#{seq}	
	</select> -->
	
	
	
	

</mapper>