<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.dao.ProductDAO">

	<!-- 해당 지역 중고물품 -->
	<select id="getProductList" resultType="ProductVO" parameterType="String">
		SELECT *
		FROM product_sale
		<if test="area != '전체'">
		WHERE product_area = #{product_area}
		</if>
	</select>
	
	<!-- 해당 상품 조회 -->
	<select id="getProduct" parameterType="ProductVO" resultType="ProductVO">
		SELECT  p.sale_id sale_id, p.sale_name sale_name, p.member_id member_id,
				p.sale_descript sale_descript, p.sale_regdate sale_regdate,
				i.productimg_name productimg_name, i.productimg_alias productimg_alias
		FROM 	product_sale p LEFT OUTER JOIN product_image i
		ON 		p.sale_id = i.sale_id
		WHERE 	p.sale_id = ${sale_id}
   </select>
	
	<!-- 중고 상품 등록 -->
	<insert id="insertProduct" parameterType="ProductVO">
        INSERT INTO product_sale 
        (sale_cate, sale_name, sale_descript, sale_price, sale_regdate, sale_status, member_id, sale_area)
        VALUES (#{sale_cate}, #{sale_name}, #{sale_descript}, #{sale_price}, NOW(), '판매 중', #{member_id}, #{sale_area})
	</insert>
	
	<!-- 상품 글 수정 -->
	<update id="updateProduct" parameterType="ProductVO">
		UPDATE product_sale 
		SET
		sale_name = #{sale_name},
		sale_descript = #{sale_descript},
		sale_cate = #{sale_cate},
		sale_price = #{sale_price},
		sale_area = #{sale_area}
		WHERE sale_id =#{sale_id}
    </update>
   
   <!-- 상품 글 삭제 -->
   <delete id="deleteProduct" parameterType="ProductVO">
		DELETE FROM product_sale
		WHERE sale_id = ${sale_id}
   </delete>
   
</mapper>
